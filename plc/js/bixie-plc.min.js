/*! bixie-plc-1.0.0 - Matthijs Alles - Bixie 10-09-2014 19:24:25 */
(function(t){"use strict";var s;jQuery&&jQuery.UIkit&&(s=t(jQuery,jQuery.UIkit)),"function"==typeof define&&define.amd&&define("uikit-bixdashboard",["uikit"],function(){return s||t(jQuery,jQuery.UIkit)})})(function(t,s){"use strict";return s.component("bixdashboard",{defaults:{debug:!1,ajaxUrl:"Tags.htm",interval:1e3,keys:{now:"Now",andon:"Andon"},widgets:{tact:{type:"progress",selector:"#tactProgress"},shelf:{type:"target",selector:"#shelfTarget"},shift:{type:"progress",selector:"#shiftProgress"}}},init:function(){var e=this;t("#tactProgress"),t("#shelfTarget"),t("#shiftProgress"),this.form=this.find("form"),this.datetimes=this.find("[data-bix-datetime]"),this.errorMessage=this.find("[data-bix-error]"),this.options.debug&&(this.debugEl=this.find(".bix-debug")),e.widgets={},t.each(this.options.widgets,function(i){var n=t(this.selector);e.widgets[i]=s["bix"+this.type](n,s.Utils.options(n.attr("data-bix-"+this.type)))}),setInterval(function(){e.getData()},this.options.interval),e.getData()},getData:function(){var s=this;t.ajax({type:"POST",url:this.options.ajaxUrl,cache:!1,data:s.form.serialize()}).done(function(e){var i={};if("object"==typeof e)i=e;else try{i=JSON.parse(e.trim())}catch(n){console.log("Fout in JSON response: "+e),i.tags={}}s.datetimes.text(i.tags[s.options.keys.now]),i.tags[s.options.keys.andon]?s.errorMessage.show().find(".content").text(i.tags[s.options.keys.andon]):s.errorMessage.hide().find(".content").text(""),t.each(s.widgets,function(){this.setData(i)})}).fail(function(){}).always(function(e){s.options.debug&&s.debugEl.text(e),t.each(s.widgets,function(){this.reset(e)})})}}),s.ready(function(e){t("[data-bix-dashboard]",e).each(function(){var e=t(this);e.data("bixdashboard")||s.bixdashboard(e,s.Utils.options(e.attr("data-bix-dashboard")))})}),t.fn.ukbixdashboard}),function(t){"use strict";var s;jQuery&&jQuery.UIkit&&(s=t(jQuery,jQuery.UIkit)),"function"==typeof define&&define.amd&&define("uikit-bixprogress",["uikit"],function(){return s||t(jQuery,jQuery.UIkit)})}(function(t,s){"use strict";return s.component("bixprogress",{defaults:{type:"tact",suffix:" sec",blink:0,keys:{tact:{key:"Tact",max:"TactTijd",target:"TactTijd",marge:"TactMarge",reset:"tactReset"},shift:{key:"Shift",max:"ShiftLengte",target:"ShiftLengte",reset:"ShiftReset"}}},init:function(){var s=this;this.blinker=!1,this.blinkState=!0,this.progress=this.find("div.uk-progress-bar"),this.alertEl=this.find("div.uk-alert"),this.targetInput=this.find("input[name*="+this.options.keys[this.options.type].target+"]"),this.margeInput=this.find("input[name*="+this.options.keys[this.options.type].marge+"]"),this.resetInput=this.find("input[name*="+this.options.keys[this.options.type].reset+"]"),this.resetButton=this.find("button").click(function(){s.resetInput.val(1),t(this).addClass("uk-button-success")})},setData:function(t){var s=t.tags[this.options.keys[this.options.type].key],e=t.tags[this.options.keys[this.options.type].marge],i=t.tags[this.options.keys[this.options.type].max],n=s>=0?100*(s/i):100,r=0>s?"danger":e>=s?"warning":"success";this.options.blink&&this.setBlink(0>=s),this.progress.parent().removeClass("uk-progress-success uk-progress-warning uk-progress-danger").addClass("uk-progress-"+r),this.progress.css("width",n+"%"),this.alertEl.removeClass("uk-alert-success uk-alert-warning uk-alert-danger").addClass("uk-alert-"+r),this.alertEl.text(s+this.options.suffix),this.find("input[name*="+this.options.keys[this.options.type].target+"]:focus").length||this.targetInput.val(i),this.find("input[name*="+this.options.keys[this.options.type].marge+"]:focus").length||this.margeInput.val(e)},setBlink:function(t){var s=this;t&&!this.blinker&&(this.blinker=setInterval(function(){s.blink()},this.options.blink)),!t&&this.blinker&&(clearInterval(this.blinker),this.progress.css("opacity",1),this.blinker=!1)},blink:function(){this.blinkState?this.progress.css("opacity",0):this.progress.css("opacity",1),this.blinkState=!this.blinkState},reset:function(){this.resetInput.val(0),this.resetButton.removeClass("uk-button-success")}}),t.fn.ukbixprogress}),function(t){"use strict";var s;jQuery&&jQuery.UIkit&&(s=t(jQuery,jQuery.UIkit)),"function"==typeof define&&define.amd&&define("uikit-bixtarget",["uikit"],function(){return s||t(jQuery,jQuery.UIkit)})}(function(t,s){"use strict";return s.component("bixtarget",{defaults:{keys:{key:"Shelf",shift:"Shift",shiftLengte:"ShiftLengte",target:"ShelfTarget",marge:"ShelfMarge",reset:"ShelfReset"}},init:function(){var s=this;this.alertEl=this.find("div.uk-alert"),this.targetEl=t(".bix-target"),this.deltaEl=t(".bix-delta"),this.progressNeg=this.find("div.bix-negative div.uk-progress-bar"),this.progressPos=this.find("div.bix-positive div.uk-progress-bar"),this.targetInput=this.find("input[name*="+this.options.keys.target+"]"),this.margeInput=this.find("input[name*="+this.options.keys.marge+"]"),this.resetInput=this.find("input[name*="+this.options.keys.reset+"]"),this.resetButton=this.find("button").click(function(){s.resetInput.val(1),t(this).addClass("uk-button-success")})},setData:function(t){var s=t.tags[this.options.keys.key],e=t.tags[this.options.keys.shift]*(t.tags[this.options.keys.target]/t.tags[this.options.keys.shiftLengte]),i=s-e,n=100*(Math.abs(i)/(2*t.tags[this.options.keys.marge])),r=s>e?"success":e-t.tags[this.options.keys.marge]>s?"danger":"warning";0>i?(this.progressNeg.parent().removeClass("uk-progress-warning uk-progress-danger").addClass("uk-progress-"+r),this.progressNeg.css("width",n+"%"),this.progressPos.css("width",0)):(this.progressPos.css("width",n+"%"),this.progressNeg.css("width",0)),this.deltaEl.removeClass("uk-text-success uk-text-warning uk-text-danger").addClass("uk-text-"+r),this.alertEl.removeClass("uk-alert-success uk-alert-warning uk-alert-danger").addClass("uk-alert-"+r),this.find("input[name*=shelfTarget]:focus").length||this.targetInput.val(t.tags[this.options.keys.target]),this.find("input[name*=shelfMarge]:focus").length||this.margeInput.val(t.tags[this.options.keys.marge]),this.targetEl.text(Math.round(e)),this.deltaEl.text(Math.round(i)),this.alertEl.text(s+" stuks")},reset:function(){this.resetInput.val(0),this.resetButton.removeClass("uk-button-success")}}),s.ready(function(e){t("[data-bix-target]",e).each(function(){var e=t(this);e.data("bixtarget")||s.bixtarget(e,s.Utils.options(e.attr("data-bix-target")))})}),t.fn.ukbixtarget});