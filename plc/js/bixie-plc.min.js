/*! bixie-plc-1.0.0 - Matthijs Alles - Bixie 11-09-2014 16:37:20 */
(function(t){"use strict";var s;jQuery&&jQuery.UIkit&&(s=t(jQuery,jQuery.UIkit)),"function"==typeof define&&define.amd&&define("uikit-bixprogress",["uikit"],function(){return s||t(jQuery,jQuery.UIkit)})})(function(t,s){"use strict";return s.component("bixprogress",{defaults:{type:"tact",suffix:"",blink:0,progressbar:!0,keys:{tact:{key:"Tact",max:"TactTijd",target:"TactTijd",marge:"TactMarge",reset:"tactReset"},shift:{key:"Shift",max:"ShiftLengte",target:"ShiftLengte",reset:"ShiftReset"}}},init:function(){this.blinker=!1,this.blinkState=!0,this.options.progressbar&&(this.progress=this.find("div.uk-progress-bar"),this.progress.parent().show()),this.blinkEl=this.find(".bix-blink"),this.alertEl=this.find("div.uk-alert")},setData:function(t){var s=t.tags[this.options.keys[this.options.type].key],i=t.tags[this.options.keys[this.options.type].marge],e=t.tags[this.options.keys[this.options.type].max],n=s>=0?100*(s/e):100,r=0>s?"danger":i>=s?"warning":"success";this.options.blink&&this.setBlink(0>=s),this.options.progressbar&&(this.progress.parent().removeClass("uk-progress-success uk-progress-warning uk-progress-danger").addClass("uk-progress-"+r),this.progress.css("width",n+"%")),this.alertEl.removeClass("uk-alert-success uk-alert-warning uk-alert-danger").addClass("uk-alert-"+r),this.alertEl.text(s+this.options.suffix)},setBlink:function(t){var s=this;t&&!this.blinker&&(this.blinker=setInterval(function(){s.blink()},this.options.blink)),!t&&this.blinker&&(clearInterval(this.blinker),this.blinkEl.css("opacity",1),this.blinker=!1)},blink:function(){this.blinkState?this.blinkEl.css("opacity",0):this.blinkEl.css("opacity",1),this.blinkState=!this.blinkState}}),t.fn.ukbixprogress}),function(t){"use strict";var s;jQuery&&jQuery.UIkit&&(s=t(jQuery,jQuery.UIkit)),"function"==typeof define&&define.amd&&define("uikit-bixplcsettings",["uikit"],function(){return s||t(jQuery,jQuery.UIkit)})}(function(t,s){"use strict";return s.component("bixplcsettings",{defaults:{ajaxUrl:"Tags.htm",keys:[],buttons:{}},init:function(){var s=this;this.outputs={},this.inputs={},t.each(this.options.keys,function(){s.outputs[this]=s.find("[data-bix-output="+this+"]"),s.inputs[this]=s.find("[name*="+this+"]")}),this.buttons={},this.resets={},t.each(this.options.buttons,function(i){s.buttons[i]=s.find(this.selector),this.reset&&(s.resets[i]=t(this.reset)),s.buttons[i].click(function(){t(this).find("i").addClass("uk-icon-spin"),s.resets[i]&&s.resets[i].val(1),s.submit()})})},submit:function(){var s=this;t.ajax({type:"POST",url:this.options.ajaxUrl,cache:!1,data:s.element.serialize()}).always(function(t){s.options.debug&&console.log(t),s.reset()})},setData:function(s){var i=this;t.each(s.tags,function(t){void 0!==i.outputs[t]&&i.outputs[t].text(s.tags[t])})},reset:function(){t.each(this.inputs,function(){this.val("")}),t.each(this.resets,function(){this.val(0)}),t.each(this.buttons,function(){this.find("i").removeClass("uk-icon-spin")})}}),s.ready(function(i){t("[data-bix-plcsettings]",i).each(function(){var i=t(this);i.data("bixplcsettings")||s.bixplcsettings(i,s.Utils.options(i.attr("data-bix-plcsettings")))})}),t.fn.ukbixplcsettings}),function(t){"use strict";var s;jQuery&&jQuery.UIkit&&(s=t(jQuery,jQuery.UIkit)),"function"==typeof define&&define.amd&&define("uikit-bixtarget",["uikit"],function(){return s||t(jQuery,jQuery.UIkit)})}(function(t,s){"use strict";return s.component("bixtarget",{defaults:{suffix:"",progressbar:!0,keys:{key:"Shelf",shift:"Shift",shiftLengte:"ShiftLengte",target:"ShelfTarget",marge:"ShelfMarge",reset:"ShelfReset"}},init:function(){this.alertEl=this.find("div.uk-alert"),this.targetEl=t(".bix-target"),this.deltaEl=t(".bix-delta"),this.options.progressbar&&(this.progressNeg=this.find("div.bix-negative div.uk-progress-bar"),this.progressPos=this.find("div.bix-positive div.uk-progress-bar"),this.progressPos.closest(".uk-grid").show())},setData:function(t){var s=t.tags[this.options.keys.key],i=t.tags[this.options.keys.shift]*(t.tags[this.options.keys.target]/t.tags[this.options.keys.shiftLengte]),e=s-i,n=100*(Math.abs(e)/(2*t.tags[this.options.keys.marge])),r=s>i?"success":i-t.tags[this.options.keys.marge]>s?"danger":"warning";this.options.progressbar&&(0>e?(this.progressNeg.parent().removeClass("uk-progress-warning uk-progress-danger").addClass("uk-progress-"+r),this.progressNeg.css("width",n+"%"),this.progressPos.css("width",0)):(this.progressPos.css("width",n+"%"),this.progressNeg.css("width",0))),this.deltaEl.removeClass("uk-text-success uk-text-warning uk-text-danger").addClass("uk-text-"+r),this.deltaEl.text(Math.round(e)),console.log(t),console.log(this.alertEl),this.alertEl.removeClass("uk-alert-success uk-alert-warning uk-alert-danger").addClass("uk-alert-"+r),this.alertEl.text(s+this.options.suffix),this.targetEl.text(Math.round(i))}}),s.ready(function(i){t("[data-bix-target]",i).each(function(){var i=t(this);i.data("bixtarget")||s.bixtarget(i,s.Utils.options(i.attr("data-bix-target")))})}),t.fn.ukbixtarget}),function(t){"use strict";var s;jQuery&&jQuery.UIkit&&(s=t(jQuery,jQuery.UIkit)),"function"==typeof define&&define.amd&&define("uikit-bixdashboard",["uikit"],function(){return s||t(jQuery,jQuery.UIkit)})}(function(t,s){"use strict";return s.component("bixdashboard",{defaults:{debug:!1,ajaxUrl:"Tags.htm",interval:1e3,keys:{now:"Now",andon:"Andon"},widgets:{tact:{type:"progress",selector:"#tactProgress"},shelf:{type:"target",selector:"#bixShelfTarget"},settings:{type:"plcsettings",selector:"#plcSettings"}}},init:function(){var i=this;t("#tactProgress"),t("#shelfTarget"),t("#shiftProgress"),this.form=this.find("form"),this.datetimes=this.find("[data-bix-datetime]"),this.errorMessage=this.find("[data-bix-error]"),i.widgets={},t.each(this.options.widgets,function(e){var n=t(this.selector);i.widgets[e]=s["bix"+this.type](n,s.Utils.options(n.attr("data-bix-"+this.type)))}),setInterval(function(){i.getData()},this.options.interval),i.getData()},getData:function(){var s=this;t.ajax({type:"POST",url:this.options.ajaxUrl,cache:!1}).done(function(i){var e={};if("object"==typeof i)e=i;else try{e=JSON.parse(i.trim())}catch(n){console.log("Fout in JSON response: "+i),e.tags={}}s.datetimes.text(e.tags[s.options.keys.now]),e.tags[s.options.keys.andon]?s.errorMessage.show().find(".content").text(e.tags[s.options.keys.andon]):s.errorMessage.hide().find(".content").text(""),t.each(s.widgets,function(){this.setData(e)})}).fail(function(){}).always(function(t){s.options.debug&&console.log(t)})}}),s.ready(function(i){t("[data-bix-dashboard]",i).each(function(){var i=t(this);i.data("bixdashboard")||s.bixdashboard(i,s.Utils.options(i.attr("data-bix-dashboard")))})}),t.fn.ukbixdashboard});